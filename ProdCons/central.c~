
// Autor: Mariela Curiel 
#include <sys/types.h>
#include <sys/stat.h>
#include <stdio.h>
#include <stdlib.h>
#include <fcntl.h>
#include <signal.h>
#include <unistd.h>
#include "empleados.h" 

int main (int argc, char **argv)
{
  int fd, pid, n, bytes, cuantos, creado;
  emple em;
  
  mode_t fifo_mode = S_IRUSR | S_IWUSR;
  
  if (mkfifo (argv[1], fifo_mode) == -1) {
     perror("mkfifo");
     exit(1);
  }

  
  
     fd = open (argv[1], O_RDONLY);
     if (fd == -1) {
         perror("pipe");
         exit (0);
      }

  printf ("Abrio el pipe\n");
  
  do {
    cuantos = read (fd, &em, sizeof(emple)); // recordar validar llamadas al sistema
    if (cuantos == 0) break;
    printf (" se leyo %d %f %s, cuantos = %d \n", em.edad, em.salario, em.nombre, cuantos);
  } while (cuantos > 0);
 
    
  close(fd);
  unlink(argv[1]);
}
